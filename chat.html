<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="thumbnail.jpg?v=2" sizes="32x32" type="image/png">
    <link rel="stylesheet" href="style.css">
    <title>KiyoEditz</title>
</head>
<body>
    <div class="container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <button class="menu-toggle" id="menu-toggle">☰</button>
            <nav>
                <ul>
                    <li><a href="index.html" class="nav-link">Profile</a></li>
                    <li><a href="galeri.html" class="nav-link">Galeri</a></li>
                    <li><a href="talent.html" class="nav-link">Talent</a></li>
                    <li><a href="contact.html" class="nav-link">Contact</a></li>   
                </ul>
            </nav>
        </aside>
        <script>
            // Pilih elemen yang diperlukan
            const sidebar = document.querySelector('.sidebar');
            const toggleButton = document.getElementById('menu-toggle');
        
            // Tambahkan event listener ke tombol toggle
            toggleButton.addEventListener('click', () => {
                sidebar.classList.toggle('active'); // Tambahkan/hapus kelas 'active'
            });
        </script>
        <!-- Main Content -->
        <main class="content">
            <section class="chat-section">
                <h2>Tanya AI Kiyo</h2>
                <form id="chat-form">
                    <input type="text" id="chat-input" placeholder="Tanyakan sesuatu..." required />
                    <button type="submit">Kirim</button>
                </form>
                <div id="chat-output"></div>
            </section>
            
        </main>

        <!-- Footer -->
        <footer class="footer">
            <ul>
                <li><a href="https://www.instagram.com/kiyoeditz"><img src="instagram.png" alt="Instagram"><span>Instagram</span></a></li>
                <li><a href="https://www.facebook.com/profile.php?id=100077102250480&mibextid=ZbWKwL"><img src="facebook.png" alt="Facebook"><span>Facebook</span></a></li>
                <li><a href="https://discord.com/users/813365850979041302"><img src="discord.png" alt="Discord"><span>Discord</span></a></li>
                <li><a href="https://youtube.com/@kiyo_editz?si=ZFzdmehe8snTEIBn"><img src="youtube.png" alt="YouTube"><span>YouTube</span></a></li>
            </ul>
            <p>© 2025 KiyoTech.Corp. All Rights Reserved.</p>
        </footer>
    </div>
    <script>
        document.getElementById('chat-form').addEventListener('submit', async function (e) {
            e.preventDefault();
            const prompt = document.getElementById('chat-input').value;
            const outputDiv = document.getElementById('chat-output');
        
            outputDiv.innerHTML += `<div><strong>Kamu:</strong> ${prompt}</div>`;
            document.getElementById('chat-input').value = '';
        
            outputDiv.innerHTML += `<div><em>AI sedang mengetik...</em></div>`;
        
            try {
                const response = await fetch('https://www.blackbox.ai/api/chat', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Accept-Language': 'id-ID,id;q=0.9,en-US;q=0.8,en;q=0.7',
                        'Origin': 'https://www.blackbox.ai',
                        'User-Agent': navigator.userAgent
                    },
                    body: JSON.stringify({
                        messages: [{ role: "user", content: prompt, id: "web-client" }],
                        agentMode: {},
                        id: "web-client",
                        codeModelMode: true,
                        maxTokens: 1024,
                        webSearchModePrompt: true
                    })
                });
        
                const reader = response.body.getReader();
                const decoder = new TextDecoder();
                let result = '';
                let textDone = false;
        
                while (!textDone) {
                    const { done, value } = await reader.read();
                    if (done) {
                        textDone = true;
                        break;
                    }
        
                    const chunk = decoder.decode(value, { stream: true });
                    result += chunk;
                }
        
                const match = result.match(/\$~~~\$(.*?)\$~~~\$/);
                if (match) {
                    const searchData = JSON.parse(match[1]);
                    const searchText = searchData.map((item, i) => {
                        return `${i + 1}. ${item.title || item.text || 'Tanpa Judul'}\n${item.url || ''}`;
                    }).join('<br>');
                    outputDiv.innerHTML += `<div><strong>AI:</strong><br>${searchText}</div>`;
                } else {
                    outputDiv.innerHTML += `<div><strong>AI:</strong> ${result.replace(/\$~~~\$.*?\$~~~\$/g, '')}</div>`;
                }
            } catch (error) {
                console.error('Terjadi kesalahan:', error);
                outputDiv.innerHTML += `<div style="color: red;"><strong>Terjadi kesalahan saat memproses permintaan.</strong></div>`;
            }
        });
        </script>
        
</body>
</html>